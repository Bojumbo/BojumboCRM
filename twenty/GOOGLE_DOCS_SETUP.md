# Google Docs Integration - Setup Guide

## –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —à–∞–±–ª–æ–Ω—É –≤ Google Docs

### –ö—Ä–æ–∫ 1: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è Google Cloud Service Account
1. ‚úÖ **–ó–∞–≤–µ—Ä—à–µ–Ω–æ** - Service Account —Ñ–∞–π–ª –≤–∂–µ –¥–æ–¥–∞–Ω–æ: `bojumbocrm-ed53600525ac.json`

### –ö—Ä–æ–∫ 1.5: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–∞–ø–∫–∏ –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è (–í–∞–∂–ª–∏–≤–æ!)
–û—Å–∫—ñ–ª—å–∫–∏ Service Account –º–∞—î –æ–±–º–µ–∂–µ–Ω–µ —Å—Ö–æ–≤–∏—â–µ (15 –ì–ë), —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏ —É –≤–∞—à—ñ–π –æ—Å–æ–±–∏—Å—Ç—ñ–π –ø–∞–ø—Ü—ñ –Ω–∞ Google Drive.

1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ [Google Drive](https://drive.google.com)
2. –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤—É –ø–∞–ø–∫—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "Generated Documents")
3. –í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ü—é –ø–∞–ø–∫—É
4. –°–∫–æ–ø—ñ—é–π—Ç–µ ID –ø–∞–ø–∫–∏ –∑ URL –∞–¥—Ä–µ—Å–∏:
   ```
   https://drive.google.com/drive/folders/[–¶–ï_ID_–ü–ê–ü–ö–ò]
   ```
5. –ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Ü—ñ—î—é –ø–∞–ø–∫–æ—é –∑ Service Account:
   - –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞–∑–≤—É –ø–∞–ø–∫–∏ -> **Share**
   - –î–æ–¥–∞–π—Ç–µ email: `bojumbocrm@bojumbocrm.iam.gserviceaccount.com`
   - –ù–∞–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∞ **"Editor"**
6. –í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ñ–∞–π–ª `.env` —É –ø—Ä–æ–µ–∫—Ç—ñ —Ç–∞ –¥–æ–¥–∞–π—Ç–µ ID –ø–∞–ø–∫–∏:
   ```env
   GOOGLE_DRIVE_FOLDER_ID=–≤–∞—à–µ_id_–ø–∞–ø–∫–∏
   ```

### –ö—Ä–æ–∫ 2: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —à–∞–±–ª–æ–Ω—É –¥–æ–∫—É–º–µ–Ω—Ç—É
1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ [Google Docs](https://docs.google.com)
2. –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π –¥–æ–∫—É–º–µ–Ω—Ç
3. –î–æ–¥–∞–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–æ–∫—É–º–µ–Ω—Ç—É –∑ **–∑–º—ñ–Ω–Ω–∏–º–∏** —É —Ñ–æ—Ä–º–∞—Ç—ñ `{{variable_name}}`

**–î–æ—Å—Ç—É–ø–Ω—ñ –∑–º—ñ–Ω–Ω—ñ:**
- `{{title}}` - –Ω–∞–∑–≤–∞ —É–≥–æ–¥–∏
- `{{doc_number}}` - –Ω–æ–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç—É
- `{{amount}}` - —Å—É–º–∞ —É–≥–æ–¥–∏
- `{{cp_name}}` - –Ω–∞–∑–≤–∞ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞
- `{{date}}` - –ø–æ—Ç–æ—á–Ω–∞ –¥–∞—Ç–∞
- `{{products_table}}` - —Ç–∞–±–ª–∏—Ü—è —Ç–æ–≤–∞—Ä—ñ–≤ (–±—É–¥–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∞)

**–ü—Ä–∏–∫–ª–∞–¥ —à–∞–±–ª–æ–Ω—É:**
```
–î–û–ì–û–í–Ü–† ‚Ññ{{doc_number}}

–ü—Ä–µ–¥–º–µ—Ç: {{title}}
–î–∞—Ç–∞: {{date}}
–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç: {{cp_name}}
–°—É–º–∞: {{amount}}

–¢–æ–≤–∞—Ä–∏ —Ç–∞ –ø–æ—Å–ª—É–≥–∏:
{{products_table}}

________________________
–ü—ñ–¥–ø–∏—Å
```

### –ö—Ä–æ–∫ 3: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É
1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –≤–∞—à –¥–æ–∫—É–º–µ–Ω—Ç —É Google Docs
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É **"Share"** (–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è)
3. –£ –ø–æ–ª—ñ email –¥–æ–¥–∞–π—Ç–µ –∞–¥—Ä–µ—Å—É –≤–∞—à–æ–≥–æ Service Account:
   ```
   bojumbocrm@bojumbocrm.iam.gserviceaccount.com
   ```
   (—Ç–æ—á–Ω—É –∞–¥—Ä–µ—Å—É –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ —É —Ñ–∞–π–ª—ñ `bojumbocrm-ed53600525ac.json` —É –ø–æ–ª—ñ `client_email`)
4. –ù–∞–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∞ **"Editor"**
5. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Done"**

### –ö—Ä–æ–∫ 4: –û—Ç—Ä–∏–º–∞–Ω–Ω—è Google Doc ID
1. –°–∫–æ–ø—ñ—é–π—Ç–µ URL –≤–∞—à–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç—É. –í—ñ–Ω –≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫:
   ```
   https://docs.google.com/document/d/1ABC-xyz123_EXAMPLE_ID/edit
   ```
2. Google Doc ID - —Ü–µ —á–∞—Å—Ç–∏–Ω–∞ –º—ñ–∂ `/d/` —Ç–∞ `/edit`:
   ```
   1ABC-xyz123_EXAMPLE_ID
   ```

### –ö—Ä–æ–∫ 5: –î–æ–¥–∞–≤–∞–Ω–Ω—è —à–∞–±–ª–æ–Ω—É –≤ CRM
1. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É [Templates](http://localhost:3001/admin/templates)
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Initialize Blueprint"**
3. –í–≤–µ–¥—ñ—Ç—å:
   - **Template Name**: –Ω–∞–∑–≤—É —à–∞–±–ª–æ–Ω—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "–î–æ–≥–æ–≤—ñ—Ä –∫—É–ø—ñ–≤–ª—ñ-–ø—Ä–æ–¥–∞–∂—É")
   - **Google Doc ID**: ID —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–∏–π –∑ URL
4. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Link to Registry"**

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –±—É–¥—å-—è–∫—É —É–≥–æ–¥—É (Deal)
2. –£ —Å–µ–∫—Ü—ñ—ó **"Document Synthesis"** –≤–∏–±–µ—Ä—ñ—Ç—å –ø–æ—Ç—Ä—ñ–±–Ω–∏–π —à–∞–±–ª–æ–Ω
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"Generate"**
4. –°–∏—Å—Ç–µ–º–∞:
   - –°—Ç–≤–æ—Ä–∏—Ç—å –∫–æ–ø—ñ—é —à–∞–±–ª–æ–Ω—É
   - –ó–∞–º—ñ–Ω–∏—Ç—å –≤—Å—ñ –∑–º—ñ–Ω–Ω—ñ —Ä–µ–∞–ª—å–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏
   - –ó–≥–µ–Ω–µ—Ä—É—î —Ç–∞–±–ª–∏—Ü—é —Ç–æ–≤–∞—Ä—ñ–≤ (—è–∫—â–æ –≤–æ–Ω–∏ —î)
   - –ï–∫—Å–ø–æ—Ä—Ç—É—î –¥–æ–∫—É–º–µ–Ω—Ç —É DOCX
   - –ó–±–µ—Ä–µ–∂–µ —É –≤–∞—à—É CRM
   - –ù–∞–¥–∞—Å—Ç—å –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –ø–µ—Ä–µ–≥–ª—è–¥ —É Google Docs

## Troubleshooting

### –ù–∞–π—á–∞—Å—Ç—ñ—à—ñ –ø–æ–º–∏–ª–∫–∏

#### ‚ùå "Template not found" –∞–±–æ "File not found"

**–ü—Ä–∏—á–∏–Ω–∏:**
1. Google Doc ID –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π
2. Service Account –Ω–µ –º–∞—î –¥–æ—Å—Ç—É–ø—É –¥–æ –¥–æ–∫—É–º–µ–Ω—Ç—É
3. –î–æ–∫—É–º–µ–Ω—Ç –≤–∏–¥–∞–ª–µ–Ω–æ –∞–±–æ –ø–µ—Ä–µ–º—ñ—â–µ–Ω–æ

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ—Å—Ç—å Google Doc ID:
   - –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç —É –±—Ä–∞—É–∑–µ—Ä—ñ
   - URL –º–∞—î –≤–∏–≥–ª—è–¥: `https://docs.google.com/document/d/[–¶–ï_ID]/edit`
   - –°–∫–æ–ø—ñ—é–π—Ç–µ —Ç—ñ–ª—å–∫–∏ —á–∞—Å—Ç–∏–Ω—É –º—ñ–∂ `/d/` —Ç–∞ `/edit`

2. **–û–ë–û–í'–Ø–ó–ö–û–í–û** –ø–æ–¥—ñ–ª—ñ—Ç—å—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–º –∑ Service Account:
   ```
   1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ Google Doc
   2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É "Share" (–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è) —É –ø—Ä–∞–≤–æ–º—É –≤–µ—Ä—Ö–Ω—å–æ–º—É –∫—É—Ç—ñ
   3. –£ –ø–æ–ª—ñ "Add people and groups" –≤–≤–µ–¥—ñ—Ç—å email –≤–∞—à–æ–≥–æ Service Account
      (–∑–Ω–∞–π–¥—ñ—Ç—å –π–æ–≥–æ —É —Ñ–∞–π–ª—ñ bojumbocrm-ed53600525ac.json ‚Üí "client_email")
   4. –í–∏–±–µ—Ä—ñ—Ç—å —Ä–æ–ª—å "Editor" (–ù–ï "Viewer"!)
   5. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "Send" –∞–±–æ "Done"
   ```

3. –ó–∞–ø—É—Å—Ç—ñ—Ç—å —Ç–µ—Å—Ç–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:
   ```bash
   node test-google-docs.js YOUR_GOOGLE_DOC_ID
   ```

#### ‚ùå "Failed to authenticate with Google"

**–ü—Ä–∏—á–∏–Ω–∏:**
- –§–∞–π–ª `bojumbocrm-ed53600525ac.json` –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ
- –§–∞–π–ª –ø–æ—à–∫–æ–¥–∂–µ–Ω–æ –∞–±–æ –º–∞—î –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —Ñ–∞–π–ª —ñ—Å–Ω—É—î –≤ –∫–æ—Ä–µ–Ω–µ–≤—ñ–π –ø–∞–ø—Ü—ñ –ø—Ä–æ–µ–∫—Ç—É
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ —Ü–µ –≤–∞–ª—ñ–¥–Ω–∏–π JSON —Ñ–∞–π–ª
3. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —Ñ–∞–π–ª –º–∞—î –ø—Ä–∞–≤–∏–ª—å–Ω—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É (–º—ñ—Å—Ç–∏—Ç—å `client_email`, `private_key` —Ç–æ—â–æ)

#### ‚ùå "Permission denied" –∞–±–æ "Access denied"

**–ü—Ä–∏—á–∏–Ω–∏:**
- Service Account –Ω–µ –º–∞—î –ø—Ä–∞–≤ –Ω–∞ –¥–æ—Å—Ç—É–ø –¥–æ –¥–æ–∫—É–º–µ–Ω—Ç—É
- –ü—Ä–∞–≤–∞ –Ω–∞–¥–∞–Ω–æ —è–∫ "Viewer" –∑–∞–º—ñ—Å—Ç—å "Editor"

**–†—ñ—à–µ–Ω–Ω—è:**
1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ Google Doc
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "Share"
3. –ó–Ω–∞–π–¥—ñ—Ç—å email Service Account —É —Å–ø–∏—Å–∫—É
4. –ó–º—ñ–Ω—ñ—Ç—å –ø—Ä–∞–≤–∞ –∑ "Viewer" –Ω–∞ "**Editor**"
5. –ó–±–µ—Ä–µ–∂—ñ—Ç—å –∑–º—ñ–Ω–∏

### –î—ñ–∞–≥–Ω–æ—Å—Ç–∏—á–Ω–∏–π —Å–∫—Ä–∏–ø—Ç

–î–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É –¥–æ —à–∞–±–ª–æ–Ω—É –∑–∞–ø—É—Å—Ç—ñ—Ç—å:

```bash
node test-google-docs.js YOUR_GOOGLE_DOC_ID
```

–¶–µ–π —Å–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç—å:
- ‚úÖ –ù–∞—è–≤–Ω—ñ—Å—Ç—å credentials —Ñ–∞–π–ª—É
- ‚úÖ –£—Å–ø—ñ—à–Ω—É –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é
- ‚úÖ –î–æ—Å—Ç—É–ø –¥–æ –≤–∫–∞–∑–∞–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç—É
- ‚úÖ –ü—Ä–∞–≤–∞ –Ω–∞ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç—É

**–ü—Ä–∏–∫–ª–∞–¥ –≤–∏–≤–æ–¥—É –ø—Ä–∏ —É—Å–ø—ñ—Ö—É:**
```
üîç Testing Google Docs Integration...

Step 1: Checking credentials file...
‚úÖ Credentials file found

Step 2: Loading credentials...
‚úÖ Credentials loaded
   Service Account Email: bojumbocrm@bojumbocrm.iam.gserviceaccount.com

Step 3: Authenticating with Google...
‚úÖ Authentication successful

Step 4: Testing Drive API access...
‚úÖ Template found!
   Name: My Template Document
   Type: application/vnd.google-apps.document
   ID: 1ABC-xyz123

Step 5: Checking permissions...
‚úÖ Service Account has access to this document

Step 6: Testing document copy...
‚úÖ Successfully created a copy of the template

üéâ All tests passed! Your Google Docs integration is working correctly.
```

### –®–≤–∏–¥–∫–∏–π —á–µ–∫–ª–∏—Å—Ç

–ü–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—î—é –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è:

- [ ] Google Docs API —Ç–∞ Google Drive API —É–≤—ñ–º–∫–Ω–µ–Ω—ñ –≤ Google Cloud Console
- [ ] –§–∞–π–ª `bojumbocrm-ed53600525ac.json` —ñ—Å–Ω—É—î –≤ –∫–æ—Ä–µ–Ω–µ–≤—ñ–π –ø–∞–ø—Ü—ñ
- [ ] Google Doc —Å—Ç–≤–æ—Ä–µ–Ω–æ —ñ –º—ñ—Å—Ç–∏—Ç—å –∑–º—ñ–Ω–Ω—ñ —É —Ñ–æ—Ä–º–∞—Ç—ñ `{{variable_name}}`
- [ ] –î–æ–∫—É–º–µ–Ω—Ç –Ω–∞–¥–∞–Ω–æ —É —Å–ø—ñ–ª—å–Ω–∏–π –¥–æ—Å—Ç—É–ø Service Account –∑ –ø—Ä–∞–≤–∞–º–∏ **"Editor"**
- [ ] Google Doc ID –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–∏–π –∑ URL
- [ ] –¢–µ—Å—Ç–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç —É—Å–ø—ñ—à–Ω–æ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è

## –ë–µ–∑–ø–µ–∫–∞

‚ö†Ô∏è –§–∞–π–ª `bojumbocrm-ed53600525ac.json` –¥–æ–¥–∞–Ω–æ –≤ `.gitignore` —ñ –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏–º–µ—Ç—å—Å—è –Ω–∞ GitHub.
–ù–µ –¥—ñ–ª—ñ—Ç—å—Å—è —Ü–∏–º —Ñ–∞–π–ª–æ–º –ø—É–±–ª—ñ—á–Ω–æ!
